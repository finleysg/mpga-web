<div fxLayout="row wrap">
  <mat-card>
    <mat-card-header class="mat-purple">
      <mat-card-title>MPGA Team Match Play</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <div *ngIf="pageContent" [markdown]="pageContent.content"></div>
    </mat-card-content>
  </mat-card>
</div>
<div fxLayout="row wrap">
  <div fxFlex.gt-sm="33%" fxFlex="100">
    <mat-card>
      <mat-card-header>
        <mat-card-title class="mat-text-primary">Search by Group</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <mat-form-field>
          <mat-select placeholder="Filter by Group" (selectionChange)="selectGroup($event)">
            <mat-option [value]="">Show All</mat-option>
            <mat-option *ngFor="let group of groups" [value]="group">
              {{group}}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <mat-slide-toggle [checked]="dataSource.isSenior" (change)="toggleSenior($event)" class="ml-3">
          Senior Teams
        </mat-slide-toggle>
      </mat-card-content>
      <mat-card-content>
        <p>
          Click on a team to get contact details about the captain or captains. You can request
          contact detail for a single team or an entire group.
        </p>
        <p>
          You must have a contact email on file with the MPGA. We will only send this information to
          a known email address.
        </p>
      </mat-card-content>
    </mat-card>
  </div>
  <div fxFlex.gt-sm="67%" fxFlex="100">
    <mat-card>
      <mat-card-header>
        <mat-card-title class="mat-text-primary">{{config.matchPlayYear}} Match Play Teams <span *ngIf="!config.matchPlayFinalized">(Tentative)</span></mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <a mat-flat-button color="accent" (click)="signup()" class="club-action" alt="Sign up for team match play">
          Sign Up Now for {{config.matchPlayYear}}
        </a>
        <table mat-table [dataSource]="dataSource" multiTemplateDataRows>
          <ng-container matColumnDef="groupName">
            <th mat-header-cell *matHeaderCellDef>Club Name</th>
            <td mat-cell *matCellDef="let item">
              {{ item.groupName }}
            </td>
          </ng-container>
          <ng-container matColumnDef="clubName">
            <th mat-header-cell *matHeaderCellDef>Club Name</th>
            <td mat-cell *matCellDef="let item">
              {{ item.club.name }}
            </td>
          </ng-container>
          <ng-container matColumnDef="captains">
            <th mat-header-cell *matHeaderCellDef>Captain(s)</th>
            <td mat-cell *matCellDef="let item">
              {{ item.captainNames(dataSource.isSenior) }}
            </td>
          </ng-container>
          <ng-container matColumnDef="contactInfo">
            <td mat-cell *matCellDef="let item" [attr.colspan]="displayedColumns.length">
              <div class="contact-info" [@detailExpand]="expandedItem && item.id === expandedItem.id ? 'expanded' : 'collapsed'">
                <div *ngFor="let captain of item.captains(dataSource.isSenior)" class="contact-info-detail">
                  <p><strong>{{ captain.contact.firstName }} {{ captain.contact.lastName }}</strong></p>
                  <p>xxxxx@{{ captain.contact.publicEmail }}</p>
                  <p>{{ captain.contact.publicPhone }}-xxx-xxxx</p>
                  <p *ngIf="captain.notes">{{ captain.notes }}</p>
                </div>
                <div>
                  <button mat-button color="accent" class="mt-1">Send Contact</button>
                </div>
              </div>
            </td>
          </ng-container>
          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let item; columns: displayedColumns" class="contact-row clickable"
            [class.expanded-contact-row]="expandedItem && expandedItem.id === item.id" (click)="toggleDetail(item)">
          </tr>
          <tr mat-row *matRowDef="let row; columns: ['contactInfo']" class="contact-info-row"></tr>
        </table>
      </mat-card-content>
    </mat-card>
  </div>
</div>